***********************************************************************************
**Get the basic infor

**#
keep hh1icap hh2icap hh3icap hh4icap hh1itot hh2itot hh3itot hh1ctot hh2ctot hh3ctot hh4ctot hh1cperc hh2cperc hh3cperc hh4cperc hh4itot hh1cfood hh2cfood hh3cfood hh4cfood r1higov r2higov r3higov r4higov s1higov s2higov s3higov s4higov r1hipriv r2hipriv r3hipriv r4hipriv s1hipriv s2hipriv s3hipriv s4hipriv r1hiothp r2hiothp r3hiothp r4hiothp s1hiothp s2hiothp s3hiothp s4hiothp r1shlt r2shlt r3shlt s1shlt s2shlt s3shlt r1shltf r2shltf r3shltf s1shltf s2shltf s3shltf r1shlta r2shlta r3shlta r4shlta s1shlta s2shlta s3shlta s4shlta r1shltaf r2shltaf r3shltaf s1shltaf s2shltaf s3shltaf r1hlthlm_c r2hlthlm_c r3hlthlm_c r4hlthlm_c s1hlthlm_c s2hlthlm_c s3hlthlm_c s4hlthlm_c r3hlthlm r4hlthlm s3hlthlm s4hlthlm r1dressa r2dressa r3dressa r4dressa s1dressa s2dressa s3dressa s4dressa r1batha r2batha r3batha r4batha s1batha s2batha s3batha s4batha r1eata r2eata r3eata r4eata s1eata s2eata s3eata s4eata r1beda r2beda r3beda r4beda s1beda s2beda s3beda s4beda r1toilta r2toilta r3toilta r4toilta s1toilta s2toilta s3toilta s4toilta r1urina r2urina r3urina r4urina s1urina s2urina s3urina s4urina r2phonea r3phonea r4phonea s2phonea s3phonea s4phonea r1moneya r2moneya r3moneya r4moneya s1moneya s2moneya s3moneya s4moneya r1medsa r2medsa r3medsa r4medsa s1medsa s2medsa s3medsa s4medsa r1shopa r2shopa r3shopa r4shopa s1shopa s2shopa s3shopa s4shopa r1mealsa r2mealsa r3mealsa r4mealsa s1mealsa s2mealsa s3mealsa s4mealsa r1housewka r2housewka r3housewka r4housewka s1housewka s2housewka s3housewka s4housewka r1joga r2joga r3joga r4joga s1joga s2joga s3joga s4joga r1walk1kma r2walk1kma r3walk1kma r4walk1kma s1walk1kma s2walk1kma s3walk1kma s4walk1kma r1walk100a r2walk100a r3walk100a r4walk100a s1walk100a s2walk100a s3walk100a s4walk100a r1chaira r2chaira r3chaira r4chaira s1chaira s2chaira s3chaira s4chaira r1climsa r2climsa r3climsa r4climsa s1climsa s2climsa s3climsa s4climsa r1stoopa r2stoopa r3stoopa r4stoopa s1stoopa s2stoopa s3stoopa s4stoopa r1lifta r2lifta r3lifta r4lifta s1lifta s2lifta s3lifta s4lifta r1dimea r2dimea r3dimea r4dimea s1dimea s2dimea s3dimea s4dimea r1armsa r2armsa r3armsa r4armsa s1armsa s2armsa s3armsa s4armsa r1adla_c r2adla_c r3adla_c r4adla_c s1adla_c s2adla_c s3adla_c s4adla_c r1adlab_c r2adlab_c r3adlab_c r4adlab_c s1adlab_c s2adlab_c s3adlab_c s4adlab_c r1adlwa r2adlwa r3adlwa r4adlwa s1adlwa s2adlwa s3adlwa s4adlwa r1adlwam r2adlwam r3adlwam r4adlwam s1adlwam s2adlwam s3adlwam s4adlwam r1adlam_c r2adlam_c r3adlam_c r4adlam_c s1adlam_c s2adlam_c s3adlam_c s4adlam_c r1adlabm_c r2adlabm_c r3adlabm_c r4adlabm_c s1adlabm_c s2adlabm_c s3adlabm_c s4adlabm_c r1adlfive r2adlfive r3adlfive r4adlfive s1adlfive s2adlfive s3adlfive s4adlfive r1adlfivem r2adlfivem r3adlfivem r4adlfivem s1adlfivem s2adlfivem s3adlfivem s4adlfivem r2iadla r3iadla r4iadla s2iadla s3iadla s4iadla r2iadlam r3iadlam r4iadlam s2iadlam s3iadlam s4iadlam r2iadlza r3iadlza r4iadlza s2iadlza s3iadlza s4iadlza r2iadlzam r3iadlzam r4iadlzam s2iadlzam s3iadlzam s4iadlzam r1mobilsev r2mobilsev r3mobilsev r4mobilsev s1mobilsev s2mobilsev r1igxfr r2igxfr r3igxfr r4igxfr s1igxfr s2igxfr s3igxfr s4igxfr s3mobilsev s4mobilsev r1mobilsevm r2mobilsevm r3mobilsevm r4mobilsevm s1mobilsevm s2mobilsevm s3mobilsevm s4mobilsevm r1lowermob r2lowermob r3lowermob r4lowermob s1lowermob s2lowermob s3lowermob s4lowermob r1lowermobm r2lowermobm r3lowermobm r4lowermobm s1lowermobm s2lowermobm s3lowermobm s4lowermobm r1uppermob r2uppermob r3uppermob r4uppermob s1uppermob s2uppermob s3uppermob s4uppermob r1uppermobm r2uppermobm r3uppermobm r4uppermobm s1uppermobm s2uppermobm s3uppermobm r1iothr r2iothr r3iothr r4iothr s1iothr s2iothr s3iothr s4iothr hh1iothhh hh2iothhh hh3iothhh hh4iothhh hh1itot hh2itot hh3itot hh4itot s4uppermobm r1hibpe r2hibpe r3hibpe r4hibpe s1hibpe s2hibpe s3hibpe s4hibpe r1hibpf r2hibpf r3hibpf r4hibpf s1hibpf s2hibpf s3hibpf s4hibpf r1diabe r2diabe r3diabe r4diabe s1diabe s2diabe s3diabe s4diabe r1diabf r2diabf r3diabf r4diabf s1diabf s2diabf s3diabf s4diabf r1cancre hh1ctot hh2ctot hh3ctot hh4ctot hh1cperc hh2cperc hh3cperc hh4cperc r2cancre r3cancre r4cancre s1cancre s2cancre s3cancre s4cancre r1cancrf r2cancrf r3cancrf r4cancrf s1cancrf s2cancrf s3cancrf s4cancrf r1lunge r2lunge r3lunge r4lunge s1lunge s2lunge s3lunge s4lunge r1lungf r2lungf h1hhres h2hhres h3hhres h4hhres r3lungf r4lungf s1lungf s2lungf s3lungf s4lungf r1hearte r2hearte r3hearte r4hearte s1hearte s2hearte s3hearte s4hearte r1heartf r2heartf r3heartf r4heartf s1heartf s2heartf s3heartf s4heartf r1stroke r2stroke r3stroke r4stroke s1stroke s2stroke s3stroke s4stroke r1strokf r2strokf r3strokf r4strokf s1strokf s2strokf s3strokf s4strokf r1psyche r2psyche r3psyche r4psyche s1psyche s2psyche s3psyche s4psyche r1psychf r2psychf r3psychf r4psychf s1psychf s2psychf s3psychf s4psychf r1arthre r2arthre r3arthre r4arthre s1arthre r1ipen r2ipen r3ipen r4ipen s1ipen s2ipen s3ipen s4ipen s2arthre s3arthre s4arthre r1arthrf r2arthrf r3arthrf r4arthrf s1arthrf s2arthrf s3arthrf s4arthrf r1dyslipe r2dyslipe r3dyslipe r4dyslipe s1dyslipe s2dyslipe s3dyslipe s4dyslipe r1dyslipf r2dyslipf r3dyslipf r4dyslipf s1dyslipf s2dyslipf s3dyslipf s4dyslipf r1livere r2livere r3livere r4livere s1livere s2livere s3livere s4livere r1liverf r2liverf r3liverf r4liverf s1liverf s2liverf s3liverf s4liverf r1kidneye r2kidneye r3kidneye r4kidneye s1kidneye s2kidneye s3kidneye s4kidneye r1kidneyf r2kidneyf r3kidneyf r4kidneyf s1kidneyf s2kidneyf s3kidneyf s4kidneyf r1digeste r2digeste r3digeste r4digeste s1digeste s2digeste s3digeste s4digeste r1digestf r2digestf r3digestf r4digestf s1digestf s2digestf s3digestf s4digestf r1asthmae r2asthmae r3asthmae r4asthmae s1asthmae s2asthmae s3asthmae s4asthmae r1asthmaf r2asthmaf r3asthmaf r4asthmaf s1asthmaf s2asthmaf s3asthmaf s4asthmaf r1memrye r2memrye r3memrye r4memrye s1memrye s2memrye s3memrye s4memrye r1memryf r2memryf r3memryf r4memryf s1memryf s2memryf s3memryf s4memryf r1rxhibp r2rxhibp r3rxhibp r4rxhibp s1rxhibp s2rxhibp s3rxhibp s4rxhibp r1rxhibp_c r2rxhibp_c r3rxhibp_c r4rxhibp_c s1rxhibp_c s2rxhibp_c s3rxhibp_c s4rxhibp_c r1rxdiabi r2rxdiabi r3rxdiabi r4rxdiabi s1rxdiabi s2rxdiabi s3rxdiabi s4rxdiabi r1rxdiab r2rxdiab r3rxdiab r4rxdiab s1rxdiab s2rxdiab s3rxdiab s4rxdiab r1rxdiab_c r2rxdiab_c r3rxdiab_c r4rxdiab_c s1rxdiab_c s2rxdiab_c s3rxdiab_c s4rxdiab_c r1cncrmeds r2cncrmeds r3cncrmeds r4cncrmeds s1cncrmeds s2cncrmeds s3cncrmeds s4cncrmeds r1cncrmeds_c r2cncrmeds_c r3cncrmeds_c r4cncrmeds_c s1cncrmeds_c s2cncrmeds_c s3cncrmeds_c s4cncrmeds_c r1cncrchem r2cncrchem r3cncrchem r4cncrchem s1cncrchem s2cncrchem s3cncrchem s4cncrchem r1cncrsurg r2cncrsurg r3cncrsurg r4cncrsurg s1cncrsurg s2cncrsurg s3cncrsurg s4cncrsurg r1cncrradn r2cncrradn r3cncrradn r4cncrradn s1cncrradn s2cncrradn s3cncrradn s4cncrradn r1rxlung r2rxlung r3rxlung r4rxlung s1rxlung s2rxlung s3rxlung s4rxlung r1rxlung_c r2rxlung_c r3rxlung_c r4rxlung_c s1rxlung_c s2rxlung_c s3rxlung_c s4rxlung_c r1rxheart r2rxheart r3rxheart r4rxheart s1rxheart s2rxheart s3rxheart s4rxheart r1rxheart_c r2rxheart_c r3rxheart_c r4rxheart_c s1rxheart_c s2rxheart_c s3rxheart_c s4rxheart_c r1rxstrok r2rxstrok r3rxstrok r4rxstrok s1rxstrok s2rxstrok s3rxstrok s4rxstrok r1rxstrok_c r2rxstrok_c r3rxstrok_c r4rxstrok_c s1rxstrok_c s2rxstrok_c s3rxstrok_c s4rxstrok_c r1rxpsych r2rxpsych r3rxpsych r4rxpsych s1rxpsych s2rxpsych s3rxpsych s4rxpsych r1trpsych r2trpsych r3trpsych r4trpsych s1trpsych s2trpsych s3trpsych s4trpsych r1rxarthr r2rxarthr r3rxarthr r4rxarthr s1rxarthr s2rxarthr s3rxarthr s4rxarthr r1rxarthr_c r2rxarthr_c r3rxarthr_c r4rxarthr_c s1rxarthr_c s2rxarthr_c s3rxarthr_c s4rxarthr_c r1rxdyslip r2rxdyslip r3rxdyslip r4rxdyslip s1rxdyslip s2rxdyslip s3rxdyslip s4rxdyslip r1rxdyslip_c r2rxdyslip_c r3rxdyslip_c r4rxdyslip_c s1rxdyslip_c s2rxdyslip_c s3rxdyslip_c s4rxdyslip_c r1rxliver r2rxliver r3rxliver r4rxliver s1rxliver s2rxliver s3rxliver s4rxliver r1rxliver_c r2rxliver_c r3rxliver_c r4rxliver_c s1rxliver_c s2rxliver_c s3rxliver_c s4rxliver_c r1rxkidney r2rxkidney r3rxkidney r4rxkidney s1rxkidney s2rxkidney s3rxkidney s4rxkidney r1rxkidney_c r2rxkidney_c r3rxkidney_c r4rxkidney_c s1rxkidney_c s2rxkidney_c s3rxkidney_c s4rxkidney_c r1rxdigest r2rxdigest r3rxdigest r4rxdigest s1rxdigest s2rxdigest s3rxdigest s4rxdigest r1rxdigest_c r2rxdigest_c r3rxdigest_c r4rxdigest_c s1rxdigest_c s2rxdigest_c s3rxdigest_c s4rxdigest_c r1rxmemry r2rxmemry r3rxmemry r4rxmemry s1rxmemry s2rxmemry s3rxmemry s4rxmemry r1rxmemry_c r2rxmemry_c r3rxmemry_c r4rxmemry_c s1rxmemry_c s2rxmemry_c s3rxmemry_c s4rxmemry_c r1vgact_c r2vgact_c r3vgact_c r4vgact_c s1vgact_c s2vgact_c s3vgact_c s4vgact_c r1vgactx_c r2vgactx_c r3vgactx_c r4vgactx_c s1vgactx_c s2vgactx_c s3vgactx_c s4vgactx_c r1mdact_c r2mdact_c r3mdact_c r4mdact_c s1mdact_c s2mdact_c s3mdact_c s4mdact_c r1mdactx_c r2mdactx_c r3mdactx_c r4mdactx_c s1mdactx_c s2mdactx_c s3mdactx_c s4mdactx_c r1ltact_c r2ltact_c r3ltact_c r4ltact_c s1ltact_c s2ltact_c s3ltact_c s4ltact_c r1ltactx_c r2ltactx_c r3ltactx_c r4ltactx_c s1ltactx_c s2ltactx_c s3ltactx_c s4ltactx_c  r1hosp1y r2hosp1y r3hosp1y r4hosp1y s1hosp1y s2hosp1y s3hosp1y s4hosp1y r1hsptim1y r2hsptim1y r3hsptim1y r4hsptim1y s1hsptim1y s2hsptim1y s3hsptim1y s4hsptim1y r1hspnite r2hspnite r3hspnite r4hspnite s1hspnite s2hspnite s3hspnite s4hspnite r1doctor1m r2doctor1m r3doctor1m r4doctor1m s1doctor1m s2doctor1m s3doctor1m s4doctor1m r1doctim1m r2doctim1m r3doctim1m r4doctim1m s1doctim1m s2doctim1m s3doctim1m s4doctim1m r1trdmed1m r2trdmed1m r3trdmed1m r4trdmed1m s1trdmed1m s2trdmed1m s3trdmed1m s4trdmed1m r1trdmdtim1m r2trdmdtim1m r3trdmdtim1m r4trdmdtim1m s1trdmdtim1m s2trdmdtim1m s3trdmdtim1m s4trdmdtim1m r1oophos1y r2oophos1y r3oophos1y r4oophos1y s1oophos1y s2oophos1y s3oophos1y s4oophos1y r1tothos1y r2tothos1y r3tothos1y r4tothos1y s1tothos1y s2tothos1y s3tothos1y s4tothos1y r1oopdoc1m r2oopdoc1m r3oopdoc1m r4oopdoc1m s1oopdoc1m s2oopdoc1m s3oopdoc1m s4oopdoc1m r1totdoc1m r2totdoc1m r3totdoc1m r4totdoc1m s1totdoc1m s2totdoc1m s3totdoc1m s4totdoc1m r2oopden1y r3oopden1y s2oopden1y s3oopden1y r2totden1y r3totden1y s2totden1y s3totden1y r1higov r2higov r3higov r4higov s1higov s2higov s3higov s4higov r1hipriv r2hipriv r3hipriv r4hipriv s1hipriv s2hipriv s3hipriv s4hipriv r1hiothp r2hiothp r3hiothp r4hiothp s1hiothp s2hiothp s3hiothp s4hiothp r1depresl r2depresl r3depresl   r4depresl s1depresl s2depresl s3depresl s4depresl r1effortl r2effortl r3effortl r4effortl s1effortl s2effortl s3effortl s4effortl r1sleeprl r2sleeprl r3sleeprl r4sleeprl s1sleeprl s2sleeprl s3sleeprl s4sleeprl r1whappyl r2whappyl r3whappyl r4whappyl s1whappyl s2whappyl s3whappyl s4whappyl r1flonel r2flonel r3flonel r4flonel s1flonel s2flonel s3flonel s4flonel r1botherl r2botherl r3botherl r4botherl s1botherl s2botherl s3botherl s4botherl r1goingl r2goingl r3goingl r4goingl s1goingl s2goingl s3goingl s4goingl r1mindtsl r2mindtsl r3mindtsl r4mindtsl s1mindtsl s2mindtsl s3mindtsl s4mindtsl r1fhopel r2fhopel r3fhopel r4fhopel s1fhopel s2fhopel s3fhopel s4fhopel r1fearll r2fearll r3fearll r4fearll s1fearll s2fearll s3fearll s4fearll r1cesd10 r2cesd10 r3cesd10 r4cesd10 s1cesd10 s2cesd10 s3cesd10 s4cesd10 r1cesd10m r2cesd10m r3cesd10m r4cesd10m s1cesd10m s2cesd10m s3cesd10m s4cesd10m r1jcpen r2jcpen r3jcpen r4jcpen r1othpen r2othpen r3othpen r4othpen r1peninc r2peninc r3peninc r4peninc r1pubpen r2pubpen r3pubpen r4pubpen r1retemp r2retemp r3retemp r4retemp s1retemp s2retemp s3retemp s4retemp r1fret_c r2fret_c r3fret_c r4fret_c s1fret_c s2fret_c s3fret_c s4fret_c r2jbonus r3jbonus r4jbonus s2jbonus s3jbonus s4jbonus r1work r2work r3work r4work s1work s2work s3work s4work r1work2 r2work2 r3work2 r4work2 s1work2 s2work2 s3work2 s4work2 r1lbrf_c r2lbrf_c r3lbrf_c r4lbrf_c s1lbrf_c s2lbrf_c s3lbrf_c s4lbrf_c r1slfemp r2slfemp r3slfemp r4slfemp s1slfemp s2slfemp s3slfemp s4slfemp r1jhours_c r2jhours_c r3jhours_c r4jhours_c s1jhours_c s2jhours_c s3jhours_c s4jhours_c r1jhour2 r2jhour2 r3jhour2 r4jhour2 s1jhour2 s2jhour2 s3jhour2 s4jhour2 r1jhourtot r2jhourtot r3jhourtot r4jhourtot s1jhourtot s2jhourtot s3jhourtot s4jhourtot r1jweeks_c r2jweeks_c r3jweeks_c r4jweeks_c s1jweeks_c s2jweeks_c s3jweeks_c s4jweeks_c r1jgovtemp r2jgovtemp r3jgovtemp r4jgovtemp s1jgovtemp s2jgovtemp s3jgovtemp s4jgovtemp r1jsalary_c r2jsalary_c r3jsalary_c r4jsalary_c s1jsalary_c s2jsalary_c s3jsalary_c  s4jsalary_c h1frec h2frec h3frec h4frec h1tgiv h2tgiv h3tgiv h4tgiv h1ftot h2ftot h3ftot h4ftot h1frec h2frec h3frec h4frec h1tgiv h2tgiv h3tgiv h4tgiv h1child h2child h3child h4child r1livsib r2livsib r3livsib  r4livsib ragender r1agey r2agey r3agey r4agey raeduc_c s1educ_c s2educ_c s3educ_c s4educ_c raeducl r1hukou r2hukou r3hukou r4hukou ID householdID h1rural h2rural h3rural h4rural ID communityID hhid hhidc pnc pn ID_w1 householdID_w1 s1id s2id s3id s4id s1pn s2pn s3pn s4pn raspid1 raspid2 inw1 inw2 inw3 inw4 r1iwstat r2iwstat r3iwstat r4iwstat s1iwstat s2iwstat s3iwstat s4iwstat hacohort_c r1wthh r2wthh r3wthh r4wthh r2wthhl r1wthha r2wthha r3wthha r4wthha r1wtresp r2wtresp r3wtresp r4wtresp s1wtresp s2wtresp s3wtresp s4wtresp r2wtrespl s2wtrespl r1wtrespa r2wtrespa r3wtrespa s1wtrespa s2wtrespa s3wtrespa r1wtrespb r2wtrespb r3wtrespb r4wtrespb s1wtrespb s2wtrespb s3wtrespb s4wtrespb r1wtrespbioa s1wtrespbioa r1wtrespbiob r2wtrespbiob r3wtrespbiob s1wtrespbiob s2wtrespbiob s3wtrespbiob h1hhresp h2hhresp h3hhresp h4hhresp h1cpl h2cpl h3cpl h4cpl r1famr r2famr r3famr r4famr s1famr s2famr s3famr s4famr h1anyfam h2anyfam h3anyfam h4anyfam r1iwy r2iwy r3iwy r4iwy r1doctor1m r2doctor1m r3doctor1m r4doctor1m s1doctor1m s2doctor1m s3doctor1m s4doctor1m r1doctim1m r2doctim1m r3doctim1m r4doctim1m s1doctim1m s2doctim1m s3doctim1m s4doctim1m r1ipen r2ipen r3ipen r4ipen s1ipen s2ipen s3ipen s4ipen r1isfpen r2isfpen s1isfpen s2isfpen r1igxfr r2igxfr r3igxfr r4igxfr s1igxfr s2igxfr s3igxfr s4igxfr hh1igxfro hh2igxfro hh3igxfro hh4igxfro hh1igxfri hh2igxfri hh3igxfri hh4igxfri hh1igxfrh hh2igxfrh hh3igxfrh hh4igxfrh hh1igxfrt hh2igxfrt hh3igxfrt hh4igxfrt hh1igxfr hh2igxfr hh3igxfr hh4igxfr r1iothr r2iothr r3iothr r4iothr s1iothr s2iothr s3iothr s4iothr hh1iothhh hh2iothhh hh3iothhh hh4iothhh hh1itot hh2itot hh3itot hh4itot h1rural h2rural h3rural h4rural


**get main IV, to be consistent with CESD-10 cut off score (Andresen et al., 1994).
**I will minus 1 on every response 
**reverse coded happy and hopeful question
foreach var in r1depresl r2depresl r3depresl r4depresl s1depresl s2depresl s3depresl s4depresl r1effortl r2effortl r3effortl r4effortl s1effortl s2effortl s3effortl s4effortl r1sleeprl r2sleeprl r3sleeprl r4sleeprl s1sleeprl s2sleeprl s3sleeprl s4sleeprl r1whappyl r2whappyl r3whappyl r4whappyl s1whappyl s2whappyl s3whappyl s4whappyl r1flonel r2flonel r3flonel r4flonel s1flonel s2flonel s3flonel s4flonel r1botherl r2botherl r3botherl r4botherl s1botherl s2botherl s3botherl s4botherl r1goingl r2goingl r3goingl r4goingl s1goingl s2goingl s3goingl s4goingl r1mindtsl r2mindtsl r3mindtsl r4mindtsl s1mindtsl s2mindtsl s3mindtsl s4mindtsl r1fhopel r2fhopel r3fhopel r4fhopel s1fhopel s2fhopel s3fhopel s4fhopel r1fearll r2fearll r3fearll r4fearll s1fearll s2fearll s3fearll s4fearll {
    replace `var' = `var' - 1
}
foreach var in r1whappyl r2whappyl r3whappyl r4whappyl s1whappyl s2whappyl s3whappyl s4whappyl r1fhopel r2fhopel r3fhopel r4fhopel s1fhopel s2fhopel s3fhopel s4fhopel {
    recode `var' (0 = 3) (1 = 2) (2 = 1) (3 = 0)
}


foreach var in r1depresl r2depresl r3depresl r4depresl s1depresl s2depresl s3depresl s4depresl r1effortl r2effortl r3effortl r4effortl s1effortl s2effortl s3effortl s4effortl r1sleeprl r2sleeprl r3sleeprl r4sleeprl s1sleeprl s2sleeprl s3sleeprl s4sleeprl r1whappyl r2whappyl r3whappyl r4whappyl s1whappyl s2whappyl s3whappyl s4whappyl r1flonel r2flonel r3flonel r4flonel s1flonel s2flonel s3flonel s4flonel r1botherl r2botherl r3botherl r4botherl s1botherl s2botherl s3botherl s4botherl r1goingl r2goingl r3goingl r4goingl s1goingl s2goingl s3goingl s4goingl r1mindtsl r2mindtsl r3mindtsl r4mindtsl s1mindtsl s2mindtsl s3mindtsl s4mindtsl r1fhopel r2fhopel r3fhopel r4fhopel s1fhopel s2fhopel s3fhopel s4fhopel r1fearll r2fearll r3fearll r4fearll s1fearll s2fearll s3fearll s4fearll {
    label values `var' depression_scale
}
												

** gen new cesd score amd label
gen r1cesd_score = r1depresl + r1effortl +  r1sleeprl +  r1whappyl +  r1flonel +  r1botherl +r1goingl +  r1mindtsl +  r1fhopel +  r1fearll
gen r2cesd_score = r2depresl + r2effortl +  r2sleeprl +  r2whappyl +  r2flonel +  r2botherl +r2goingl +  r2mindtsl +  r2fhopel +  r2fearll
gen r3cesd_score = r3depresl + r3effortl +  r3sleeprl +  r3whappyl +  r3flonel +  r3botherl +r3goingl +  r3mindtsl +  r3fhopel +  r3fearll
gen r4cesd_score = r4depresl + r4effortl +  r4sleeprl +  r4whappyl +  r4flonel +  r4botherl +r4goingl +  r4mindtsl +  r4fhopel +  r4fearll

gen s1cesd_score = s1depresl + s1effortl +  s1sleeprl +  s1whappyl +  s1flonel +  s1botherl + s1goingl +  s1mindtsl +  s1fhopel +  s1fearll
gen s2cesd_score = s2depresl + s2effortl +  s2sleeprl +  s2whappyl +  s2flonel +  s2botherl +s2goingl +  s2mindtsl +  s2fhopel +  s2fearll
gen s3cesd_score = s3depresl + s3effortl +  s3sleeprl +  s3whappyl +  s3flonel +  s3botherl +s3goingl +  s3mindtsl +  s3fhopel +  s3fearll
gen s4cesd_score = s4depresl + s4effortl +  s4sleeprl +  s4whappyl +  s4flonel +  s4botherl +s4goingl +  s4mindtsl +  s4fhopel +  s4fearll


foreach round in 1 2 3 4 {
    label variable r`round'cesd_score "r`round'cesd_score: w`round' cesd score adjusted"
	label variable s`round'cesd_score "s`round'cesd_score: w`round' cesd score adjusted"
}


** gen dummy of r and s ; and label 
foreach round in 1 2 3 4 {
    gen r`round'DPdummy = .
    
    replace r`round'DPdummy = 1 if r`round'cesd_score >= 10 & r`round'cesd_score != .
    
    replace r`round'DPdummy = 0 if r`round'cesd_score < 10 & r`round'cesd_score != .
}

foreach round in 1 2 3 4 {
	gen s`round'DPdummy = .
    
    replace s`round'DPdummy = 1 if s`round'cesd_score >= 10 & s`round'cesd_score != .
    
    replace s`round'DPdummy = 0 if s`round'cesd_score < 10 & s`round'cesd_score != .
}

foreach round in 1 2 3 4 {
    label variable r`round'DPdummy "r`round'DPdummy: w`round' respondent depression status"
	label variable s`round'DPdummy "s`round'DPdummy: w`round' spouse depression status"
}

**gen annual work hours and labels
foreach round in 1 2 3 4 {
    gen r`round'annual_wrkhrs = .
    
    replace r`round'annual_wrkhrs = r`round'jhourtot * r`round'jweeks_c
    
    replace r`round'annual_wrkhrs = 0 if r`round'work == 0
}

foreach round in 1 2 3 4 {
	gen s`round'annual_wrkhrs = .
    
    replace s`round'annual_wrkhrs = s`round'jhourtot * s`round'jweeks_c
    
    replace s`round'annual_wrkhrs = 0 if s`round'work == 0 
}


foreach round in 1 2 3 4 {
    label variable r`round'annual_wrkhrs "r`round'annual_wrkhrs: w`round' respondent total hours worked/year"
	label variable s`round'annual_wrkhrs "s`round'annual_wrkhrs: w`round' spouse total hours worked/year"
}

**drop cesd question
drop r1depresl r2depresl r3depresl r4depresl s1depresl s2depresl s3depresl s4depresl r1effortl r2effortl r3effortl r4effortl s1effortl s2effortl s3effortl s4effortl r1sleeprl r2sleeprl r3sleeprl r4sleeprl s1sleeprl s2sleeprl s3sleeprl s4sleeprl r1whappyl r2whappyl r3whappyl r4whappyl s1whappyl s2whappyl s3whappyl s4whappyl r1flonel r2flonel r3flonel r4flonel s1flonel s2flonel s3flonel s4flonel r1botherl r2botherl r3botherl r4botherl s1botherl s2botherl s3botherl s4botherl r1goingl r2goingl r3goingl r4goingl s1goingl s2goingl s3goingl s4goingl r1mindtsl r2mindtsl r3mindtsl r4mindtsl s1mindtsl s2mindtsl s3mindtsl s4mindtsl r1fhopel r2fhopel r3fhopel r4fhopel s1fhopel s2fhopel s3fhopel s4fhopel r1fearll r2fearll r3fearll r4fearll s1fearll s2fearll s3fearll s4fearll


**gen if you have the insurance 
foreach round in 1 2 3 4 {
    gen r`round'insur = .
    
    replace r`round'insur = 1 if r`round'higov == 1 | r`round'hipriv == 1 | r`round'hiothp == 1 
    
    replace r`round'insur = 0 if r`round'higov == 0 & r`round'hipriv == 0 & r`round'hiothp == 0 
}

foreach round in 1 2 3 4 {
	gen s`round'insur = .
    
    replace s`round'insur = 1 if s`round'higov == 1 | s`round'hipriv == 1 | s`round'hiothp == 1 
    
    replace s`round'insur = 0 if s`round'higov == 0 & s`round'hipriv == 0 & s`round'hiothp == 0 
}


foreach round in 1 2 3 4 {
    label variable r`round'insur "r`round'insur: w`round' respondent insurance status"
	label variable s`round'insur "s`round'insur: w`round' spouse insurance status"
}


**gen pension status
foreach round in 1 2 3 4 {
    gen r`round'pension_status = .
    
    replace r`round'pension_status = 1 if r`round'pubpen == 1 | r`round'peninc  == 1 | r`round'othpen == 1 | r`round'jcpen == 1 
    
    replace r`round'pension_status = 0 if r`round'pubpen == 0 & r`round'peninc  == 0 & r`round'othpen == 0 & r`round'jcpen == 0 
}

foreach round in 1 2 3 4 {
    label variable r`round'pension_status "r`round'pension_status: w`round' respondant pension status"
}


**ID
keep ID householdID communityID hhid hhidc pnc pn ID_w1 s1id s2id s3id s4id s1pn s2pn s3pn s4pn inw1 inw2 inw3 inw4 hacohort_c r1wthh r2wthh r3wthh r4wthh r2wthhl r1wthha r2wthha r3wthha r4wthha r1wtresp r2wtresp r3wtresp r4wtresp s1wtresp s2wtresp s3wtresp s4wtresp r2wtrespl s2wtrespl r1wtrespa r2wtrespa r3wtrespa s1wtrespa s2wtrespa s3wtrespa r1wtrespb r2wtrespb r3wtrespb r4wtrespb s1wtrespb s2wtrespb s3wtrespb s4wtrespb h1hhresp h2hhresp h3hhresp h4hhresp r1agey r2agey r3agey r4agey ragender raeduc_c s1educ_c s2educ_c s3educ_c s4educ_c raeducl r1hukou r2hukou r3hukou r4hukou h1rural h2rural h3rural h4rural r1shlt r2shlt r3shlt s1shlt s2shlt s3shlt r1adlabm_c r2adlabm_c r3adlabm_c r4adlabm_c s1adlabm_c s2adlabm_c s3adlabm_c s4adlabm_c hh1igxfr hh2igxfr hh3igxfr hh4igxfr hh1itot hh2itot hh3itot hh4itot h1child h2child h3child h4child r1livsib r2livsib r3livsib r4livsib h1ftot h2ftot h3ftot h4ftot r1work r2work r3work r4work s1work s2work s3work s4work r1lbrf_c r2lbrf_c r3lbrf_c r4lbrf_c s1lbrf_c s2lbrf_c s3lbrf_c s4lbrf_c r1retemp r2retemp r3retemp r4retemp s1retemp s2retemp s3retemp s4retemp r1fret_c r2fret_c r3fret_c r4fret_c s1fret_c s2fret_c s3fret_c s4fret_c r1annual_wrkhrs r2annual_wrkhrs r3annual_wrkhrs r4annual_wrkhrs s1annual_wrkhrs s2annual_wrkhrs s3annual_wrkhrs s4annual_wrkhrs r1insur r2insur r3insur r4insur s1insur s2insur s3insur s4insur r1pension_status r2pension_status r3pension_status r4pension_status r1cesd10 r2cesd10 r3cesd10 r4cesd10 s1cesd10 s2cesd10 s3cesd10 s4cesd10 r1cesd10m r2cesd10m r3cesd10m r4cesd10m s1cesd10m s2cesd10m s3cesd10m s4cesd10m r1cesd_score r2cesd_score r3cesd_score r4cesd_score s1cesd_score s2cesd_score s3cesd_score s4cesd_score r1DPdummy r2DPdummy r3DPdummy r4DPdummy s1DPdummy s2DPdummy s3DPdummy s4DPdummy r1adlab_c r2adlab_c r3adlab_c r4adlab_c s1adlab_c s2adlab_c s3adlab_c s4adlab_c

**Above organize data
***********************************************************************************
**Below drop data

drop householdID_w1 
drop hhid hhidc 
drop pnc pn ID_w1 s1id s2id s3id s4id s1pn s2pn s3pn s4pn hhid hhidc
drop r2wthhl r2wtrespl s2wtrespl raeducl

drop if r1agey <45| r2agey <45| r3agey<45|  r4agey<45

**Filter the household with only 2 people (4,493 observations deleted)
**(2,731 observations deleted)
egen household_count = count(householdID), by(householdID)
drop if household_count == 1 | household_count == 3 | household_count == 4
drop if h1hhresp == 1 | h2hhresp == 1 | h3hhresp== 1 | h4hhresp== 1
drop h1hhresp h2hhresp h3hhresp h4hhresp


**drop only one wave
gen wave_count = inw1 + inw2 + inw3 + inw4

***********************************************************************************
**After reshaping in the R (Written by R.)
use "/Users/zhangxiangyu/Desktop/Capstone/DATA/mydata2.dta"
destring wave_num wave_num_from_variables,replace    

gen wave_num = wave_num_from_variables
gen inwave = 1 if !missing(r_wthh)
replace inwave = 0 if missing(r_wthh)
destring inwave,replace    

gen year = 2011 if wave_num ==1
replace year = 2013 if wave_num ==2
replace year = 2015 if wave_num ==3
replace year = 2018 if wave_num ==4
order year wave_num inwave, after(communityID)

drop inw1 inw2 inw3 inw4
drop wave_num_from_variables
** drop onerespondents
label variable r_adlab_c "ADL R"
label variable r_ftot "HH income"
label variable r_work "Work Status"
label variable r_work "Work Status R"
drop s_educ_c r_lbrf_c s_lbrf_c

**educ variables
** 0 is "below elementary" 1 is "elementary" 2 is "middle school" 3 is "high school and above " 
gen educ = 0 if raeduc_c == 1 |  raeduc_c == 2 | raeduc_c == 3
replace educ = 1 if raeduc_c == 4
replace educ = 2 if raeduc_c == 5
replace educ = 3 if raeduc_c == 6 | raeduc_c == 7 | raeduc_c == 8 | raeduc_c == 9 | raeduc_c == 10

**labels 
label variable year "Year"
label variable wave_num "Wave number"
label variable inwave "Wave status"
label variable r_annual_wrkhrs "Annual work hours"
label variable r_annual_wrkhrs "Respondents Annual work hours"
label variable r_annual_wrkhrs "Respondents Annual Work Hours"
label variable s_annual_wrkhrs "Spouse Annual Work Hours"
label variable r_work "Respondent Work Status"
label variable s_work "Spouse Work Status"
label variable r_DPdummy "Respondent Depression dummy"
label variable s_DPdummy "Spouse Depression dummy"
label variable r_agey "Age"
label variable ragender "Gender"
label variable raeduc_c "Education Attainment"
label variable r_hukou "Hukou Type"
label variable r_adlab_c "Respondents ADL 6-item score"
label variable s_adlab_c "Spouse ADL 6-item score"
label variable r_retemp "R"
label variable r_retemp "R whether retired"
label variable s_retemp "S whether retired"
label variable r_pension_status "r pension status"
label variable r_livsib "r_ number of live siblings"
label variable r_child "r_number of child"
label variable r_insur "r_insurance status"
label variable s_insur "s_insur status"
label variable r_wthh "household weight without non-response adjustment"
label variable r_wthha "household weight with non-response adjustment"
label variable r_wtresp "individual weight without non-response adjustmen"
label variable s_wtresp "s weight without non-response adjustment"
label variable r_wtrespa "individual weight with HH non-response adjustme"
label variable s_wtrespa "s individual weight with HH non-response adjustme"
label variable r_wtrespb "individual weight with HH/ind non-response adju"
label variable s_wtrespb "s weight with HH/ind non-response adju"
label variable r_adlabm_c "r Missings ADL-6 item summary"
label variable s_adlabm_c "s Missings ADL-6 item summary"
label variable r_igxfr "HHold government transfer income"
label variable r_itot "HHold total household income"
label variable r_fret_c "r whether formal retirement"
label variable s_fret_c "s whether formal retirement"
label variable educ "Education attainment in categories"
label variable r_rural "live in rural"

order householdID communityID year wave_num inwave r_annual_wrkhrs s_annual_wrkhrs r_work s_work r_DPdummy s_DPdummy r_agey ragender raeduc_c r_hukou r_adlab_c s_adlab_c r_retemp s_retemp r_pension_status r_livsib r_child r_insur s_insur r_ftot, after(ID)

**hukou variable
** 1 is "rural" 2 is "urban" 3 is "Unified residence hukou", but i make it into urban 
replace r_hukou = 2 if r_hukou == 3 

* replace 4 with hukou type in other wave numbers.
gen hukou_adj = r_hukou
bysort ID: egen hukou_reported = max(cond(r_hukou != 4, r_hukou, .))
replace hukou_adj = hukou_reported if hukou_adj == 4

**rural men is 1, rural women is 2, urban men is 3, urban women is 4 
gen gender_hukou = .
replace gender_hukou = 1 if r_hukou == 1 & ragender == 1
replace gender_hukou = 2 if r_hukou == 1 & ragender == 2
replace gender_hukou = 3 if r_hukou == 2 & ragender == 1
replace gender_hukou = 4 if r_hukou == 2 & ragender == 2

**age in 5 years 
gen age_c = .
replace age_c = 1 if r_agey >=45 & r_agey < 50 
replace age_c = 2 if r_agey >=50 & r_agey < 55 
replace age_c = 3 if r_agey >=55 & r_agey < 60 
replace age_c = 4 if r_agey >=60 & r_agey < 65 
replace age_c = 5 if r_agey >=65 & r_agey < 70 
replace age_c = 6 if r_agey >=70 

**gen wavenumber dummies

gen wave1_dummy = (wave_num == 1) & (inwave == 1)
gen wave2_dummy = (wave_num == 2) & (inwave == 1)
gen wave3_dummy = (wave_num == 3) & (inwave == 1)
gen wave4_dummy = (wave_num == 4) & (inwave == 1)

*gen edyc dummies
gen educ0_dummy = (educ == 0)
gen educ1_dummy = (educ == 1) 
gen educ2_dummy = (educ == 2) 
gen educ3_dummy = (educ == 3) 

**gen standardized score (z-score) for CESD score
** Respondents: 10 has z_score .34867501 
** Spouse: 10 has z_score .3447715
egen z_r_cesd10 = std(r_cesd10)
egen z_s_cesd10 = std(s_cesd10)

**find outliers using Q1-1.5*IQR and Q3 + 1.5*IQR
** drop outliers after checking using sum, detail. there is now way a people can work 10k hrs per year 
** 576 outliers 
graph box r_annual_wrkhrs
sum r_annual_wrkhrs, detail
gen double iqr = r(p75) - r(p25)
gen byte outlier = r_annual_wrkhrs < r(p25) - 1.5*iqr | r_annual_wrkhrs > r(p75) + 1.5*iqr
replace outlier = . if missing(r_annual_wrkhrs)									 


***********************************************************************************
*Figure 1, comparing with graphs generated by R
**lowese respondents wrkhrs
twoway (lowess r_annual_wrkhrs z_r_cesd10 if (gender_hukou == 1), clstyle(p5) clwidth(medthick) clpattern(dash)) || (lowess r_annual_wrkhrs z_r_cesd10 if (gender_hukou == 2), clstyle(p5) clwidth(medthick)) || (lowess r_annual_wrkhrs z_r_cesd10 if (gender_hukou == 3), clstyle(p5) clwidth(medthick) clpattern(longdash_dot))|| (lowess r_annual_wrkhrs z_r_cesd10 if (gender_hukou == 4), clstyle(p5) clwidth(medthick) clpattern(dot)), legend(label(1 "Agri Male") label(2 "Agri Female") label(3 "Urban Male")label(4 "Urban Female")) ytitle("Respondent's Annual Work Hours") xtitle("Standardized CESD Score" " ") t2title("Respondent's Annual Work Hours and CESD Score Across Gender and Hukou Status")
graph save fig1a.gph, replace	

**lowese spouse wrkhrs
twoway (lowess r_annual_wrkhrs z_s_cesd10 if (gender_hukou == 1), clstyle(p5) clwidth(medthick) clpattern(dash)) || (lowess r_annual_wrkhrs z_s_cesd10 if (gender_hukou == 2), clstyle(p5) clwidth(medthick)) || (lowess r_annual_wrkhrs z_s_cesd10 if (gender_hukou == 3), clstyle(p5) clwidth(medthick) clpattern(longdash_dot))|| (lowess r_annual_wrkhrs z_s_cesd10 if (gender_hukou == 4), clstyle(p5) clwidth(medthick) clpattern(dot)), legend(label(1 "Agri Male") label(2 "Agri Female") label(3 "Urban Male")label(4 "Urban Female")) ytitle("Respondent's Annual Work Hours") xtitle("Standardized CESD Score" " ") t2title("Respondent's Annual Work Hours and Spouse's CESD Score Across Gender and Hukou Status") 
graph save fig1b.gph, replace	

***********************************************************************************
**Figure 2, comparing with graphs generated by R
**lowese respondents work status 
twoway (lowess r_work z_r_cesd10 if (gender_hukou == 1), clstyle(p5) clwidth(medthick) clpattern(dash)) || (lowess r_work z_r_cesd10 if (gender_hukou == 2), clstyle(p5) clwidth(medthick)) || (lowess r_work z_r_cesd10 if (gender_hukou == 3), clstyle(p5) clwidth(medthick) clpattern(longdash_dot))|| (lowess r_work z_r_cesd10 if (gender_hukou == 4), clstyle(p5) clwidth(medthick) clpattern(dot)), legend(label(1 "Agri Male") label(2 "Agri Female") label(3 "Urban Male")label(4 "Urban Female")) ytitle("Respondent's Labor Participation") xtitle("Standardized CESD Score" " ") t2title("Respondent's Labor Participation and Spouse's CESD Score Across Gender and Hukou Status")
graph save fig2a.gph, replace	

**lowese spouse work status 
twoway (lowess r_work z_s_cesd10 if (gender_hukou == 1), clstyle(p5) clwidth(medthick) clpattern(dash)) || (lowess r_work z_s_cesd10 if (gender_hukou == 2), clstyle(p5) clwidth(medthick)) || (lowess r_work z_s_cesd10 if (gender_hukou == 3), clstyle(p5) clwidth(medthick) clpattern(longdash_dot))|| (lowess r_work z_s_cesd10 if (gender_hukou == 4), clstyle(p5) clwidth(medthick) clpattern(dot)), legend(label(1 "Agri Male") label(2 "Agri Female") label(3 "Urban Male")label(4 "Urban Female")) ytitle("Respondent's Labor Participation", gap(5)) xtitle("Standardized CESD Score" " ") t2title("Respondent's Labor Participation and Spouse's CESD Score Across Gender and Hukou Status") 
graph save fig2b.gph, replace	

***********************************************************************************
**Summary
tabstat r_annual_wrkhrs ihs_wrkhrs r_work r_DPdummy s_DPdummy r_cesd10 z_r_cesd10 r_agey ragender r_adlab_c r_livsib r_child r_ftot, by (gender_hukou) s(mean sd)

bysort gender_hukou ID: gen unique = _n == 1
egen group_unique = sum(unique), by(gender_hukou)
tab group_unique
count if missing(gender_hukou)

***********************************************************************************
**Analysis
destring ID householdID communityID, replace 
gen lnwrkhrs = log(r_annual_wrkhrs)
gen double ihs_wrkhrs = log(r_annual_wrkhrs+sqrt(r_annual_wrkhrs^2+1))
** this command generated the same result: gen wrkhrs_ihs = asinh(r_annual_wrkhrs)

**OLS Intensive, after include gender P value increase dramatically 
**Check Multicollinearity with VIF and correlation to see if the gender is strongly correalted with the DPdummy.
**AIC BIC, decide which model is preferred : log model has lower numbers. 

quietly svyset [pw= r_wthha]

** lagged level
**DV
sort ID wave_num
quietly by ID: gen dworkhrs=r_annual_wrkhrs-r_annual_wrkhrs[_n-1]
quietly by ID: gen dwork=r_work-r_work[_n-1]
quietly by ID: gen dihs_wrkhrs=ihs_wrkhrs-ihs_wrkhrs[_n-1]

**IV
quietly by ID: gen lr_DPdummy=r_DPdummy[_n-1]
quietly by ID: gen ls_DPdummy=s_DPdummy[_n-1]
quietly by ID: gen lz_r_cesd10=z_r_cesd10[_n-1]
quietly by ID: gen lz_s_cesd10=z_s_cesd10[_n-1]

**control variables
quietly by ID: gen lr_agey = r_agey[_n-1]
quietly by ID: gen lragender = ragender[_n-1]
quietly by ID: gen leduc = educ[_n-1]
quietly by ID: gen lr_hukou = r_hukou[_n-1]
quietly by ID: gen ls_adlab_c = s_adlab_c[_n-1]
quietly by ID: gen ls_retemp = s_retemp[_n-1]
quietly by ID: gen lr_pension_status = r_pension_status[_n-1]
quietly by ID: gen lr_livsib = r_livsib[_n-1]
quietly by ID: gen lr_child = r_child[_n-1]
quietly by ID: gen ls_insur = s_insur[_n-1]
quietly by ID: gen lr_ftot = r_ftot[_n-1]


outreg2 using myregIQhrs.doc, replace ctitle(Model 1)
outreg2 using myregIQhrs.doc, append ctitle(Model 2)
outreg2 using myregIQhrs.doc, append ctitle(Model 3)
outreg2 using myregIQhrs.doc, append ctitle(Model 4)
outreg2 using myregIQhrs.doc, append ctitle(Model 5)
**************************************************************************************
**************************************************************************************
**  INTENSIVE
**1A.OLS wrkhrs and dummy (Maybe not using r_annual_wrkhrs at all)

**OLS : reg wrkhrs on with dummy
reg r_annual_wrkhrs r_DPdummy s_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c i.s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myregwrkhrs_OLS.doc, replace ctitle(Model 1)

**OLS : reg wrkhrs on standardized score
reg r_annual_wrkhrs z_r_cesd10 z_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c i.s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robus
outreg2 using myregwrkhrs_OLS.doc, append ctitle(Model 2)

**OLS : reg wrkhrs on with lagged dummy
reg r_annual_wrkhrs lr_DPdummy ls_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c i.s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myregwrkhrs_OLS.doc, append ctitle(Model 3)

**OLS : reg wrkhrs on lagged standardized score
reg r_annual_wrkhrs lz_r_cesd10 lz_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c i.s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robus
outreg2 using myregwrkhrs_OLS.doc, append ctitle(Model 4)


**1B.OLS FD wrkhrs and dummy

**OLS FD: reg wrkhrs on dummy
xtset ID wave_num
xtreg D(r_annual_wrkhrs r_DPdummy s_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot)
outreg2 using myregwrkhrs_FD.doc, replace ctitle(Model 1)

**OLS FD: reg wrkhrs on standardized score
xtset ID wave_num
xtreg D(r_annual_wrkhrs z_r_cesd10 z_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot)
outreg2 using myregwrkhrs_FD.doc, append ctitle(Model 2)

**OLS FD: reg wrkhrs on lagged dummy
xtset ID wave_num
xtreg D(r_annual_wrkhrs lr_DPdummy ls_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot)
outreg2 using myregwrkhrs_FD.doc, append ctitle(Model 3)

**OLS FD: reg wrkhrs on lagged standardized score
xtset ID wave_num
xtreg D(r_annual_wrkhrs lz_r_cesd10 lz_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot)
outreg2 using myregwrkhrs_FD.doc, append ctitle(Model 4)

**1C.OLS lagged wrkhrs and dummy

**OLS lagged: Reg change in workhrs  r_DPdummy and lagged s_DPdummy
reg dworkhrs r_DPdummy s_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj i.s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwrkhrs_OLS.doc, replace ctitle(Model 1)

**OLS lagged: Reg change in work on hrs  r_z_score and lagged s_z_score
reg dworkhrs z_r_cesd10 z_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c i.s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwrkhrs_OLS.doc, append ctitle(Model 2)

**OLS lagged: Reg change in workhrs lagged r_DPdummy and lagged s_DPdummy
reg dworkhrs lr_DPdummy ls_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj i.s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwrkhrs_OLS.doc, append ctitle(Model 3)

**OLS lagged: Reg change in work on hrs lagged r_z_score and lagged s_z_score
reg dworkhrs  lz_r_cesd10 lz_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c i.s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwrkhrs_OLS.doc, append ctitle(Model 4)

**1D.OLS FD lagged wrkhrs and dummy

**OLS FD laggeed: Reg change in workhrs  r_DPdummy and lagged s_DPdummy
xtset ID wave_num
xtreg D(dworkhrs r_DPdummy s_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey ragender educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot)
outreg2 using myreg_dwrkhrs_FD.doc, replace ctitle(Model 1)

**OLS FE FD laggeed: Reg change in workhrs  r_z_score and lagged s_z_score
xtset ID wave_num
xtreg D(dworkhrs  z_r_cesd10 z_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot)
outreg2 using myreg_dwrkhrs_FD.doc, append ctitle(Model 2)

**OLS FD laggeed: Reg change in workhrs lagged r_DPdummy and lagged s_DPdummy
xtset ID wave_num
xtreg D(dworkhrs lr_DPdummy ls_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey ragender educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot)
outreg2 using myreg_dwrkhrs_FD.doc, append ctitle(Model 3)

**OLS FE FD laggeed: Reg change in workhrs lagged r_z_score and lagged s_z_score
xtset ID wave_num
xtreg D(dworkhrs lz_r_cesd10 lz_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot)
outreg2 using myreg_dwrkhrs_FD.doc, append ctitle(Model 4)

**************************************************************************************
** 2A.OLS ihs_wrkhrs

**OLS : reg ihs_wrkhrs on with dummy
reg ihs_wrkhrs r_DPdummy s_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_wrkhrsihs_OLS.doc, replace ctitle(Model 1)

**OLS : reg ihs_wrkhrs on standardized score
reg ihs_wrkhrs z_r_cesd10 z_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_wrkhrsihs_OLS.doc, append ctitle(Model 2)

**OLS : reg ihs_wrkhrs on with lagged dummy
reg ihs_wrkhrs lr_DPdummy ls_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_wrkhrsihs_OLS.doc, append ctitle(Model 3)

**OLS : reg ihs_wrkhrs on lagged standardized score
reg ihs_wrkhrs lz_r_cesd10 lz_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robus
outreg2 using myreg_wrkhrsihs_OLS.doc, append ctitle(Model 4)

** 2B.FD ihs_wrkhrs

**OLS FD: reg ihs_wrkhrs on dummy
xtset ID wave_num
xtreg D(ihs_wrkhrs r_DPdummy s_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_wrkhrsihs_FD.doc, replace ctitle(Model 1)

**OLS FD: reg ihs_wrkhrs on standardized score
xtset ID wave_num
xtreg D(ihs_wrkhrs z_r_cesd10 z_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_wrkhrsihs_FD.doc, append ctitle(Model 2)

**OLS FD: reg ihs_wrkhrs on lagged dummy
xtset ID wave_num
xtreg D(ihs_wrkhrs lr_DPdummy ls_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_wrkhrsihs_FD.doc, append ctitle(Model 3)

**OLS FD: reg ihs_wrkhrs on lagged standardized score
xtset ID wave_num
xtreg D(ihs_wrkhrs lz_r_cesd10 lz_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_wrkhrsihs_FD.doc, append ctitle(Model 4)

** 2C.OLS lagged ihs_wrkhrs

**OLS lagged: Reg change in ihs_wrkhrs  r_DPdummy and lagged s_DPdummy
reg dihs_wrkhrs r_DPdummy s_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwrkhrsihs_OLS.doc, replace ctitle(Model 1)

**OLS lagged: Reg change in ihs_wrkhrs r_z_score and lagged s_z_score
reg dihs_wrkhrs z_r_cesd10 z_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwrkhrsihs_OLS.doc, append ctitle(Model 2)

**OLS lagged: Reg change in ihs_wrkhrs lagged r_DPdummy and lagged s_DPdummy
reg dihs_wrkhrs lr_DPdummy ls_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwrkhrsihs_OLS.doc, append ctitle(Model 3)

**OLS lagged: Reg change in ihs_wrkhrs lagged r_z_score and lagged s_z_score
reg dihs_wrkhrs  lz_r_cesd10 lz_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwrkhrsihs_OLS.doc, append ctitle(Model 4)

** 2D.OLS FD lagged ihs_wrkhrs

**OLS FD laggeed: Reg change in ihs_wrkhrs r_DPdummy and lagged s_DPdummy
xtset ID wave_num
xtreg D(dihs_wrkhrs r_DPdummy s_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_dwrkhrsihs_FD.doc, replace ctitle(Model 1)

**OLS FE FD laggeed: Reg change in ihs_wrkhrs r_z_score and lagged s_z_score
xtset ID wave_num
xtreg D(dihs_wrkhrs  z_r_cesd10 z_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_dwrkhrsihs_FD.doc, append ctitle(Model 2)

**OLS FD laggeed: Reg change in ihs_wrkhrs lagged r_DPdummy and lagged s_DPdummy
xtset ID wave_num
xtreg D(dihs_wrkhrs lr_DPdummy ls_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_dwrkhrsihs_FD.doc, append ctitle(Model 3)

**OLS FE FD laggeed: Reg change in ihs_wrkhrs lagged r_z_score and lagged s_z_score
xtset ID wave_num
xtreg D(dihs_wrkhrs lz_r_cesd10 lz_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_dwrkhrsihs_FD.doc, append ctitle(Model 4)

*************************************************************************************
**extensive 
**3A. OLS and logit work status and dummy

reg r_work r_DPdummy s_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_work_OLSlogit.doc, replace ctitle(OLS Model 1)

reg r_work z_r_cesd10 z_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_work_OLSlogit.doc, append ctitle(OLS Model 2)

logit r_work r_DPdummy s_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
margins,dydx(*) post
outreg2 using myreg_work_OLSlogit.doc, append ctitle(Logit Model 3)


logit r_work z_r_cesd10 z_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
margins,dydx(*) post
outreg2 using myreg_work_OLSlogit.doc, append ctitle(Logit Model 4)



**3B. OLS FD work status and dummy

**OLS FD : work status on dummy
xtset ID wave_num
xtreg D(r_work r_DPdummy s_DPdummy) wave1_dummy wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_work_FD.doc, replace ctitle(Model 1)

**OLS FD : work status on score
xtset ID wave_num
xtreg D(r_work z_r_cesd10 z_s_cesd10) wave1_dummy wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_work_FD.doc, append ctitle(Model 2)

**OLS FD: reg work status on lagged dummy
xtset ID wave_num
xtreg D(r_work lr_DPdummy ls_DPdummy) wave1_dummy wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_work_FD.doc, append ctitle(Model 3)

**OLS FD: reg work status on lagged standardized score
xtset ID wave_num
xtreg D(r_work lz_r_cesd10 lz_s_cesd10) wave1_dummy wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_work_FD.doc, append ctitle(Model 4)

**3C. OLS lagged work status and dummy

*OLS lagged: Reg change in work status  r_DPdummy and lagged s_DPdummy
reg dwork r_DPdummy s_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwork_OLS.doc, replace ctitle(Model 1)

**OLS lagged: Reg change in work status on lagged r_z_score and lagged s_z_score
reg dwork z_r_cesd10 z_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwork_OLS.doc, append ctitle(Model 2)

**OLS lagged: Reg change in work status lagged dummy
reg dwork lr_DPdummy ls_DPdummy wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwork_OLS.doc, append ctitle(Model 3)

**OLS lagged: Reg change in work status lagged score
reg dwork lz_r_cesd10 lz_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
outreg2 using myreg_dwork_OLS.doc, append ctitle(Model 4)

**3D. OLS FD lagged work status and dummy

**OLS FD laggeed: Reg change in work status r_DPdummy and lagged s_DPdummy
xtset ID wave_num
xtreg D(dwork r_DPdummy s_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_dwork_FD.doc, replace ctitle(Model 1)

**OLS FE FD laggeed: Reg change in work status r_z_score and lagged s_z_score
xtset ID wave_num
xtreg D(dwork  z_r_cesd10 z_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_dwork_FD.doc, append ctitle(Model 2)

**reg change in work status on lagged r_DPdummy and lagged s_DPdummy
xtset ID wave_num
xtreg D(dwork lr_DPdummy ls_DPdummy) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_dwork_FD.doc, append ctitle(Model 3)

**OLS lagged FD: reg change in work status on lagged score 
xtset ID wave_num
xtreg D(dwork lz_r_cesd10 lz_s_cesd10) wave2_dummy wave3_dummy wave4_dummy D(r_agey hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot), robust
outreg2 using myreg_dwork_FD.doc, append ctitle(Model 4)

**C. work status in PSM
**PSM  dummy 
teffects psmatch (r_work) (s_DPdummy r_DPdummy wave2_dummy wave3_dummy wave4_dummy r_DPdummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot)
outreg2 using myre_work_PSM.doc, replace ctitle(Logit Model 1)

teffects psmatch (r_work) (s_DPdummy r_DPdummy wave2_dummy wave3_dummy wave4_dummy r_DPdummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot),atet
outreg2 using myre_work_PSM.doc, append ctitle(Model 2)

teffects nnmatch (r_work r_DPdummy wave2_dummy wave3_dummy wave4_dummy r_DPdummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot) (s_DPdummy)
outreg2 using myre_work_PSM.doc, append ctitle(Model 3)

teffects nnmatch (r_work r_DPdummy wave2_dummy wave3_dummy wave4_dummy r_DPdummy r_agey ragender i.educ hukou_adj s_adlab_c s_retemp r_pension_status r_livsib r_child s_insur r_ftot) (s_DPdummy), atet
outreg2 using myre_work_PSM.doc, append ctitle(Model 4)

**************************************************************************************
*************************************************************************************



**Are My Data MCAR, MAR, or MNAR?
local numvars list of all numeric variables in data set
local missvars list of all variables with missing values in data set
misstable sum, gen(miss_)
foreach var of local missvars {
local covars: list numvars - var
display _newline(3) "logit missingness of `var' on `covars'"
logit miss_`var' `covars'
foreach nvar of local covars {
display _newline(3) "ttest of `nvar' by missingness of `var'"
ttest `nvar', by(miss_`var')
}
}
**************************************************************************************
*************************************************************************************
**test for autocorrelation
xtgls ihs_wrkhrs z_s_cesd10, igls panels(heteroskedastic)
estimates store hetero
local df = e(N_g) - 1
lrtest hetero . , df(`df')


**RDD
reg r_annual_wrkhrs s_DPdummy z_r_cesd10 z_s_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c i.s_retemp r_pension_status r_livsib r_child s_insur r_ftot, robust
predict fitted_values

tw (scatter r_annual_wrkhrs z_s_cesd10) (line fitted_values z_s_cesd10 if s_DPdummy == 0,fcolor(none)) (line fitted_values z_s_cesd10 if s_DPdummy == 1,fcolor(none)),xline(0.35) legend(off)

cmogram r_annual_wrkhrs z_s_cesd10, cut(.35) scatter line(.35) lowess control(z_r_cesd10 wave2_dummy wave3_dummy wave4_dummy r_agey ragender i.educ hukou_adj s_adlab_c i.s_retemp r_pension_status r_livsib r_child s_insur r_ftot)

hist 
